function onBeforeSendSetToken(e){var a=sessionStorage.getItem("token");e.headers={Authorization:"Bearer "+a}}function onRefreshToken(e){$.ajax({url:"https://localhost:44375/api/RefreshTokenApi/GetRefreshTokens",method:"POST",contentType:"application/json",data:{token:sessionStorage.getItem("token"),refreshToken:sessionStorage.getItem("refreshToken")},success:function(e){sessionStorage.setItem("token",e.token),sessionStorage.setItem("refreshToken",e.refreshToken)}})}var csrfToken=$('meta[name="csrf_token"]').attr("content");let token="";const mainFunc={setCookie(e,a,t,n){var i="";if("m"==n){var s=new Date;s.setTime(s.getTime()+60*t*1e3),i="; expires="+s.toUTCString()}if("d"==n){s=new Date;s.setTime(s.getTime()+24*t*60*60*1e3),i="; expires="+s.toUTCString()}document.cookie=e+"="+(a||"")+i+"; path=/"},getCookie(e){for(var a=e+"=",t=document.cookie.split(";"),n=0;n<t.length;n++){for(var i=t[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(a))return i.substring(a.length,i.length)}return null},eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"},getData:(e,a)=>{$.ajax({type:"GET",url:`${BASE_URL}/${e}`,headers:{csrf_token:csrfToken},dataType:"json",beforeSend:function(e){token=mainFunc.getCookie("token"),""!=token&&e.setRequestHeader("Authorization","Bearer "+token)},complete:function(){$("#loading").removeClass("block")},success:a,error:function(e,a,t){console.log("error")}})},getDataParam:(e,a,t)=>{$.ajax({type:"POST",url:`${BASE_URL}/${e}`,dataType:"JSON",data:a,beforeSend:function(e){token=mainFunc.getCookie("token"),""!=token&&e.setRequestHeader("Authorization","Bearer "+token)},complete:function(){$("#loading").removeClass("block")},success:t,error:function(e,a,t){console.log("error")}})},saveData:(e,a)=>{$.ajax({url:`${BASE_URL}/${e}`,type:"POST",dataType:"JSON",headers:{csrf_token:csrfToken},data:a,processData:!1,contentType:!1,cache:!1,async:!1,beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+token)},success:function(e){200==e.status?Swal.fire("Succesfuly!",e.message,"success"):500==e.status?Swal.fire({icon:"error",title:"Failed!",text:e.message}):Swal.fire({icon:"error",title:"Error!",text:e.message})}})},deleteData(e,a,t){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(n=>{n.isConfirmed&&$.ajax({type:"POST",url:`${BASE_URL}/${e}`,headers:{csrf_token:csrfToken},data:a,dataType:"JSON",beforeSend:function(){token=mainFunc.getCookie("token"),""!=token&&xhr.setRequestHeader("Authorization","Bearer "+token)},success:t})})},formatIdr:e=>{let a=e,t=a.toString().split("").reverse().join(""),n=t.match(/\d{1,3}/g);return n=n.join(".").split("").reverse().join(""),n},urlify:e=>{let a=/(https?:\/\/[^\s]+)/g;return e.replace(a,function(e){return`<a href="${e}">${e}</a>`})}},verifyLogin=()=>{$.ajax({type:"POST",url:`${BASE_URL}/api/verify`,headers:{csrf_token:csrfToken},dataType:"json",success:function(e){mainFunc.setCookie("token",e.token,15,"m")},error:function(e,a,t){console.log("error"),window.location.href=BASE_URL+"/login"}})},logout=()=>{$.ajax({type:"GET",url:`${BASE_URL}/api/logout`,headers:{csrf_token:csrfToken},dataType:"json",beforeSend:function(e){mainFunc.eraseCookie("token"),mainFunc.eraseCookie("memberPictureSm"),mainFunc.eraseCookie("memberUsername"),mainFunc.eraseCookie("memberLastName"),mainFunc.eraseCookie("memberPicture"),mainFunc.eraseCookie("memberFirstName"),mainFunc.eraseCookie("memberId"),setTimeout(()=>{$("#loading").removeClass("block")},1e3)},success:function(e){200==e.status&&(mainFunc.eraseCookie("token"),mainFunc.eraseCookie("memberPictureSm"),mainFunc.eraseCookie("memberUsername"),mainFunc.eraseCookie("memberLastName"),mainFunc.eraseCookie("memberPicture"),mainFunc.eraseCookie("memberFirstName"),mainFunc.eraseCookie("memberId"),setTimeout(()=>{window.location.href=BASE_URL+"/login"},1e3))},error:function(e,a,t){console.log("error"),verifyLogin()}})};$("#btnLogout").click(function(e){return e.preventDefault(),logout(),!1});let formLogin=$("#formLogin");if(formLogin.length){let e=formLogin.find("#username"),a=formLogin.find("#password"),t=formLogin.find("#loginBtn");formLogin.submit(function(n){n.preventDefault(),t.text("Process login ..."),mainFunc.getDataParam("api/login",{csrf_token:csrfToken,username:e.val(),password:a.val()},function(e){200==e.status?(mainFunc.setCookie("token",e.token,10,"m"),mainFunc.setCookie("memberId",e.data.id,30,"d"),mainFunc.setCookie("memberUsername",e.data.username,30,"d"),mainFunc.setCookie("memberFirstName",e.data.first_name,30,"d"),mainFunc.setCookie("memberLastName",e.data.last_name,30,"d"),mainFunc.setCookie("memberPicture",e.data.picture,30,"d"),mainFunc.setCookie("memberPictureSm",e.data.picture_sm,30,"d"),t.text("Login"),setTimeout(()=>{window.location.href=BASE_URL+"/member";mainFunc.getCookie("memberUsername")},1e3),token=e.token):(t.text("Login"),Swal.fire({icon:"error",title:"Failed!",text:e.message}))})})}const header=$("#header"),fullName=header.find("#fullName"),picture=header.find("#picture"),coursesTotal=header.find("#coursesTotal"),coursesInProgress=header.find("#coursesInProgress"),menuLi=$("#menu li"),mobileMenuDashboard=$("#mobileMenuDashboard"),mobileMenuMyCourses=$("#mobileMenuMyCourses"),mobileMenuReviews=$("#mobileMenuReviews"),mobileMenuWebinar=$("#mobileMenuWebinar"),mobileMenuProfile=$("#mobileMenuProfile"),mobileMenuContact=$("#mobileMenuContact"),desktopMenuDashboard=$("#desktopMenuDashboard"),desktopMenuMyCourses=$("#desktopMenuMyCourses"),desktopMenuReviews=$("#desktopMenuReviews"),desktopMenuWebinar=$("#desktopMenuWebinar"),desktopMenuProfile=$("#desktopMenuProfile"),desktopMenuContact=$("#desktopMenuContact"),memberFirstName=mainFunc.getCookie("memberFirstName"),memberLastName=mainFunc.getCookie("memberLastName"),memberFullName=`${mainFunc.getCookie("memberFirstName")} ${mainFunc.getCookie("memberLastName")}`,memberEmail=mainFunc.getCookie("memberEmail"),memberUsername=mainFunc.getCookie("memberUsername"),memberId=mainFunc.getCookie("memberId"),memberPicture=mainFunc.getCookie("memberPicture"),memberPictureSm=mainFunc.getCookie("memberPictureSm"),membersDashboard=$("#membersDashboard"),coursesTable=e=>{mainFunc.getData("api/courses",function(a){let t=a.data,n=t.length,i="",s=0;for(let e=0;e<n;e++){s=t[e].complete/t[e].total*100;let a=s.toFixed(2);i+=`\n        <tr>\n          <td style="padding:1rem;"><a href="${BASE_URL}/member/my-courses/${t[e].course_slug}" class="btn btn-sm btn-primary ml-2">Lanjutkan</a></td>\n          <td>\n            <div class="table__box">\n              <img loading="lazy" class="table__img" src="${BASE_URL_IMAGE}/${t[e].thumbnail_sm}" alt="${t[e].course_name}">\n              <div class="table__caption">\n                <p class="table__caption__title">${t[e].course_name}</p>\n                <div>\n                  <p class="progress__caption">${a}%</p>\n                  <div class="progress">\n                    <div class="progress__value" style="width: ${a}%"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </td>\n          <td style="padding:1rem;">${t[e].total}</td>\n          <td style="padding:1rem;">${t[e].complete}</td>\n          \n        </tr>\n      `}e.html(i)})};if(""!=memberPicture&&picture.attr("src",memberPictureSm),membersDashboard.length){const e=membersDashboard.find("#dashboardBodyTable"),a=membersDashboard.find("#memberName");menuLi.removeClass("active"),desktopMenuDashboard.addClass("active"),mobileMenuDashboard.addClass("active"),a.text(memberFullName),setTimeout(()=>{coursesTable(e)},1e3)}const coursesProgress=()=>{mainFunc.getData("api/courses-progress",function(e){const a=membersDashboard.find("#infoCoursesFinished"),t=membersDashboard.find("#infoCoursesInProgress"),n=membersDashboard.find("#infoTotalCourses");membersDashboard.length&&(a.text(e.data.coursesFinished),t.text(e.data.coursesInProgress),n.text(e.data.totalCourses)),coursesInProgress.text(e.data.coursesInProgress),coursesTotal.text(e.data.totalCourses),fullName.text(memberFullName)})};if(header.length){const e=async()=>{await verifyLogin(),setTimeout(()=>{coursesProgress()},500)};e()}const myCourse=$("#myCourse"),myCourseBodyTable=myCourse.find("#myCourseBodyTable");myCourse.length&&(menuLi.removeClass("active"),desktopMenuMyCourses.addClass("active"),mobileMenuMyCourses.addClass("active"),setTimeout(()=>{coursesTable(myCourseBodyTable)},1e3));const dataCity=(e,a,t,n)=>{$.ajax({type:"GET",url:`https://codingasik.github.io/api-wilayah-indonesia/static/api/regencies/${t.val()}.json`,dataType:"json",success:function(t){let i="";i+='<option value="">Pilih Kota</option>';for(let e=0;e<t.length;e++)i+=`<option value="${t[e].id}">${t[e].name}</option>`;e.html(i),e.change(function(t){t.preventDefault();let i=e.find("option:selected").text();n.val(e.val()),a.val(i)})},error:function(e,a,t){console.log("error")}})},dataProvinsi=(e,a,t)=>{$.ajax({type:"GET",url:"https://codingasik.github.io/api-wilayah-indonesia/static/api/provinces.json",dataType:"json",success:function(n){console.log(n);let i="";i+='<option value="">Pilih Provinsi</option>';for(let e=0;e<n.length;e++)i+=`<option value="${n[e].id}">${n[e].name}</option>`;e.html(i),e.change(function(n){n.preventDefault();let i=e.find("option:selected").text();t.val(e.val()),a.val(i)})},error:function(e,a,t){console.log("error")}})},profilePage=$("#profilePage");if(profilePage.length){const e=profilePage.find("#formProfile"),a=profilePage.find("#formPassword");menuLi.removeClass("active"),desktopMenuProfile.addClass("active"),mobileMenuProfile.addClass("active");const t=profilePage.find("#firstName"),n=profilePage.find("#lastName"),i=profilePage.find("#username"),s=profilePage.find("#email"),r=profilePage.find("#gender"),o=profilePage.find("#male"),l=profilePage.find("#female"),d=profilePage.find("#dob"),c=profilePage.find("#whatsapp"),m=profilePage.find("#instagram"),u=profilePage.find("#cityId"),f=profilePage.find("#cityName"),g=profilePage.find("#provinceId"),p=profilePage.find("#provinceName"),b=profilePage.find("#idProvince"),v=profilePage.find("#idCity"),_=profilePage.find("#job"),P=profilePage.find("#skill"),h=profilePage.find("#bio"),k=profilePage.find("#picture"),y=()=>{mainFunc.getData(`api/profiles/${memberId}`,function(e){t.val(e.data.first_name),n.val(e.data.last_name),i.val(e.data.username),s.val(e.data.email),"m"==e.data.gender?o.attr("checked",!0):"f"==e.data.gender&&l.attr("checked",!0),r.val(e.data.gender),d.val(e.data.dob),c.val(e.data.whatsapp),m.val(e.data.instagram),b.val(e.data.province_id),p.val(e.data.province_name),v.val(e.data.city_id),f.val(e.data.city_name),_.val(e.data.job),P.val(e.data.skill),h.val(e.data.bio),h.val(e.data.bio),k.attr("src",e.data.picture_sm)})},C=async()=>{await setTimeout(()=>{y()},2e3);dataProvinsi(g,p,b),g.on("change",function(){u.removeClass("hidden"),dataCity(u,f,g,v)})};C(),e.submit(function(e){e.preventDefault(),mainFunc.saveData(`api/profiles/${memberId}`,new FormData(this))}),a.submit(function(e){e.preventDefault(),mainFunc.saveData(`api/change-password/${memberId}/password`,new FormData(this))})}const reviewsPage=$("#reviewsPage");if(reviewsPage.length){menuLi.removeClass("active"),desktopMenuReviews.addClass("active"),mobileMenuReviews.addClass("active");const e=reviewsPage.find("#reviewsList"),a=reviewsPage.find("#pageActive"),t=reviewsPage.find("#totalPage"),n=()=>{mainFunc.getDataParam("api/reviews",{page:a.val()},function(n){let i="",s=n.data;if(t.val(Math.ceil(n.totalPage)),0==s.length)i+='\n        <div class="text-center">\n          <p>--Belum ada review--</p>\n          <hr>\n        </div>\n        ';else for(let e=0;e<s.length;e++){if(i+=`\n          <div>\n            <div class="ulasan">\n              <img loading="lazy" class="ulasan__img" src="${s[e].picture_sm}" alt="${s[e].username}" width="60px">\n              <div class="ulasan__box">\n                <div class="ulasan__head">\n                  <div>\n                    <p><strong>${s[e].username}</strong> (${s[e].job})</p>\n                    <small class="ulasan__date">${s[e].review_at}</small>\n                    <p class="ulasan__kelas">Ulasan Kelas : <strong>${s[e].course_name}</strong></p>\n                  </div>\n                  <div class="rating__box">`,1==s[e].rating){i+=`\n            <img loading="lazy" class="rating" src="${BASE_URL}/public/members/assets/img/icon/ic_star_full.svg" alt="">`;for(let e=0;e<4;e++)i+=`\n              <img loading="lazy" class="rating" src="${BASE_URL}/public/members/assets/img/icon/ic_star_empty.svg" alt="">\n            `}else if(2==s[e].rating){for(let e=0;e<2;e++)i+=`\n            <img loading="lazy" class="rating" src="${BASE_URL}/public/members/assets/img/icon/ic_star_full.svg" alt="">`;for(let e=0;e<3;e++)i+=`\n              <img loading="lazy" class="rating" src="${BASE_URL}/public/members/assets/img/icon/ic_star_empty.svg" alt="">\n            `}else if(3==s[e].rating){for(let e=0;e<3;e++)i+=`\n            <img loading="lazy" class="rating" src="${BASE_URL}/public/members/assets/img/icon/ic_star_full.svg" alt="">`;for(let e=0;e<2;e++)i+=`\n              <img loading="lazy" class="rating" src="${BASE_URL}/public/members/assets/img/icon/ic_star_empty.svg" alt="">\n            `}else if(4==s[e].rating){for(let e=0;e<4;e++)i+=`\n            <img loading="lazy" class="rating" src="${BASE_URL}/public/members/assets/img/icon/ic_star_full.svg" alt="">`;for(let e=0;e<1;e++)i+=`\n              <img loading="lazy" class="rating" src="${BASE_URL}/public/members/assets/img/icon/ic_star_empty.svg" alt="">\n            `}else if(5==s[e].rating)for(let e=0;e<5;e++)i+=`\n            <img loading="lazy" class="rating" src="${BASE_URL}/public/members/assets/img/icon/ic_star_full.svg" alt="">`;i+=`</div>\n                </div>\n                <div class="ulasan__body">\n                <p style="line-height:140%">${s[e].review}</p>\n                </div>\n              </div>\n            </div>\n            <hr>\n      \n          </div>\n          `}i+=`\n        <!-- pagination -->\n        <div class="pagination">\n          <p class="pagination__data">\n            Showing <span id="countData">${s.length}</span> of <span id="totalData">${n.totalData}</span> entries\n          </p>\n          <div class="pagination__box">\n            <a onclick="previous()" class="pagination__arrow" href="javascript:;">\n              <img loading="lazy" src="${BASE_URL}/public/members/assets/img/icon/ic_left.svg" alt="">\n            </a>`;for(let e=1;e<=t.val();e++)i+='<a class="pagination__page',e==a.val()&&(i+=' active"'),i+=`href="javascript:;" onclick=paginate(${e})><span>${e}</span></a>\n        `;return i+=`<a onclick="next()" class="pagination__arrow" href="javascript:;">\n              <img loading="lazy" src="${BASE_URL}/public/members/assets/img/icon/ic_right.svg" alt="">\n            </a>\n          </div>\n        </div>\n      `,e.html(i),!1})};function next(){a.val()<t.val()&&(a.val(parseInt(a.val())+1),n())}function paginate(e){a.val()>1&&(a.val(e),n())}function previous(){a.val()>1&&(a.val(parseInt(a.val())-1),n())}n()}const membersWebinar=$("#membersWebinar");if(membersWebinar.length){verifyLogin(),menuLi.removeClass("active"),desktopMenuWebinar.addClass("active"),mobileMenuWebinar.addClass("active");const e=membersWebinar.find("#webinarBodyTable"),a=membersWebinar.find("#infoWebinarName"),t=membersWebinar.find("#infoWebinarDate"),n=membersWebinar.find("#modalAddWebinar"),i=membersWebinar.find("#btnAddWebinar"),s=membersWebinar.find("#modalAddQuestion"),r=membersWebinar.find("#modalAddDetail"),o=n.find("#formAddWebinar"),l=n.find("#webinar"),d=n.find("#date"),c=n.find("#description"),m=s.find("#formAddQuestion"),u=s.find("#regId"),f=s.find("#review"),g=s.find("#question"),p=r.find("#webinarName"),b=r.find("#webinarUrl"),v=r.find("#webinarLink"),_=r.find("#webinarReview"),P=r.find("#webinarQuestion"),h=r.find("#webinarAnswer"),k=()=>{mainFunc.getData("api/webinar-info",function(e){a.text(e.webinar),t.text(`${e.date} | ${e.time} WIB`)})},y=()=>{mainFunc.getData("api/webinar-list",function(e){let a="";a+='<option value="">Pilih Webinar</option>';for(let t=0;t<e.length;t++)a+=`<option data-date="${e[t].date}" data-time="${e[t].time}" data-desc="${e[t].description}" value="${e[t].id}">${e[t].webinar}</option>`;l.html(a)})};function modalWebinarClear(){l.val(""),d.text("-"),c.text("-")}l.change(function(e){e.preventDefault();let a=$("#webinar option:selected").attr("data-date"),t=$("#webinar option:selected").attr("data-time"),n=$("#webinar option:selected").attr("data-desc");d.text(`${a} - ${t}`),c.text(`${n}`)}),i.click(function(e){e.preventDefault(),y(),modalWebinarClear(),n.addClass("flex").removeClass("hidden")});const C=()=>{mainFunc.getData("api/webinar",function(a){let t=a.data,n=t.length,i="",s=1,r=0;for(let e=0;e<n;e++){r=t[e].complete/t[e].total*100;r.toFixed(2);i+=`\n          <tr>\n            <td>${s++}</td>\n            <td>${t[e].date}</td>\n            <td style="padding: 1rem .5rem;">${t[e].webinar}</td>\n            <td><a href="${t[e].url}" target="_blank">${t[e].url}</a></td>\n            <td>${t[e].review}</td>\n            <td>${t[e].question}</td>\n            <td>${t[e].answer}</td>\n            <td>\n              <button class="btn p-0  btn-success btn-sm mb-1 w-8 " title="Ajukan pertanyaan"  onclick="addQuestion(${t[e].id})">\n                <img loading="lazy" src="${BASE_URL}/public/members/assets/img/icon/ic_question.svg" alt="">\n              </button>\n                    \n              <button  class="btn p-0 btn-primary btn-sm w-8" title="Lihat Detail webinar" onclick="detailWebinar(${t[e].id})">\n                <img loading="lazy" src="${BASE_URL}/public/members/assets/img/icon/ic_eye.svg" alt="">\n              </button>\n            </td>\n          </tr>\n        `}e.html(i)})};function addQuestion(e){s.addClass("flex").removeClass("hidden"),u.val(e)}function detailWebinar(e){r.addClass("flex").removeClass("hidden"),mainFunc.getDataParam("api/webinar-detail",{reg_id:e},function(e){p.text(`${e.webinar}`),b.attr("href",e.url),v.attr("href",e.link),b.text(`${e.url}`),v.text(`${e.link}`),_.text(`${e.review}`),P.text(`${e.question} ~ At: ${e.question_at}`),h.text(`${e.answer} ~ At: ${e.answer_at}`)})}k(),C(),o.submit(function(e){e.preventDefault(),mainFunc.getDataParam("api/webinar-add",{list_id:l.val()},function(e){n.addClass("hidden").removeClass("flex"),"200"==e.status?(Swal.fire("Success",e.message,"success"),C(),modalWebinarClear()):Swal.fire({icon:"error",title:"Failed",text:e.message})})}),m.submit(function(e){e.preventDefault(),mainFunc.getDataParam("api/webinar-question",{reg_id:u.val(),review:f.val(),question:g.val()},function(e){s.addClass("hidden").removeClass("flex"),"200"==e.status?(Swal.fire("Success",e.message,"success"),C(),modalWebinarClear()):Swal.fire({icon:"error",title:"Failed",text:e.message})})})}const detailCoursePage=$("#detailCoursePage");if(detailCoursePage.length){verifyLogin();const e=detailCoursePage.find("#slug"),a=detailCoursePage.find("#courseName"),t=detailCoursePage.find("#courseTotalVideo"),n=detailCoursePage.find("#courseTotalTime"),i=detailCoursePage.find("#lessonUrl"),s=detailCoursePage.find("#lessonTitle"),r=detailCoursePage.find("#deskripsi"),o=(detailCoursePage.find("#download"),detailCoursePage.find("#tentang")),l=detailCoursePage.find("#page"),d=detailCoursePage.find("#downloadBox"),c=detailCoursePage.find("#playlistsDetail"),m=detailCoursePage.find("#valProgress"),u=detailCoursePage.find("#formRating"),f=detailCoursePage.find("#idTransactionDetail"),g=detailCoursePage.find("#idMember"),p=detailCoursePage.find("#btnReview"),b=detailCoursePage.find("#totalVideo"),v=detailCoursePage.find("#btnPrevious"),_=detailCoursePage.find("#btnNext"),P=detailCoursePage.find('[name="rating"]'),h=detailCoursePage.find('[name="review"]'),k=detailCoursePage.find("#notShow"),y=detailCoursePage.find("#reviewCount"),C=document.querySelector("#detailCoursePage #contentUpdate");1==localStorage.getItem("alert-update")&&(C.style.display="none");const w=()=>{mainFunc.getDataParam("api/courses-detail",{slug:e.val(),memberId:memberId,page:l.val()},function(e){const u=e.data.course,P=e.data.playlists,h=e.data.files,k=e.data.lessons,y=e.data.progress,C=y.length/u.total_video*100,w=C.toFixed(2);b.val(u.total_video),u.rating>0&&p.attr("disabled","disabled"),1==l.val()?v.attr("disabled","disabled"):v.removeAttr("disabled"),l.val()==b.val()?_.attr("disabled","disabled"):_.removeAttr("disabled"),f.val(u.transaction_detail_id),g.val(u.member_id),m.text(w),a.text(u.course_name),t.text(u.total_video),n.text(u.total_time),i.attr("src",u.lesson_url),r.html(`<p>${u.description}</p>`),s.text(u.lesson_name),o.html(`<p>${u.course_description}</p>`);let $="";for(let e=0;e<h.length;e++)$+=`\n          <div class="p-4 shadow-md rounded-md mb-2">\n            <p class="block w-full mb-2 pb-2 border-b-2 border-gray-back">${h[e].file_name}</p>\n            <div class="flex justify-between items-center">\n              <small class="mr-4">Noted : ${h[e].note}</small>\n              <a target="_blank" class="btn_link" href="${h[e].file_url}">Download</a>\n            </div>\n          </div>\n        `;d.html($);let x="";for(let e=0;e<P.length;e++){x+='\n          <div class="materi__box">\n            <div class="flex-between">\n              <div class="flex items-center">',2==P[e].status&&(x+='\n                <span class="mr-2 p-1 text-xs bg-danger text-white rounded-md">New</span>'),x+=`<p>${P[e].playlist_name}</p>\n              </div>\n              <a class="materi`,u.playlist_id===P[e].id&&(x+=" active"),x+=`" href="javascript:;"><img loading="lazy" src="${BASE_URL}/public/members/assets/img/icon/ic_right.svg" alt=""></a>\n            </div>\n            <div class="materi__list`,u.playlist_id===P[e].id&&(x+=" flex"),x+=' ">';for(let a=0;a<k.length;a++)if(P[e].id===k[a].playlist_id){x+=`\n                  <a href="javascript:;" onclick="toPage(${a+1})" class="materi__item `,u.id==k[a].id&&(x+=" active "),x+=`"><div class="materi__item__left" >\n                      <img loading="lazy" src="${BASE_URL}/public/members/assets/img/icon/ic_play_circle.svg" alt="">\n                      <span class="materi__title ">${k[a].lesson_name}</span>\n                    </div>\n                    <div class="materi__item__right">\n                      <small>${k[a].duration}</small>\n                      <input title="Check jika telah memahami materi" type="checkbox" name="" id="progressCheck" onclick="addProgress(${k[a].id})"`;for(let e=0;e<y.length;e++)y[e].lesson_id==k[a].id&&(x+=" checked ");x+=">\n                    </div>\n                  </a>\n                "}x+="</div>\n          </div>\n        "}c.html(x)})},x=()=>{setTimeout(()=>{const e=detailCoursePage.find(".materi"),a=detailCoursePage.find(".tab__link"),t=detailCoursePage.find(".tab__content");for(let e=0;e<a.length;e++)$(a[e]).click(function(e){e.preventDefault();let n=$(this).attr("data-tabs");a.removeClass("active"),$(this).addClass("active"),$(t).addClass("hidden"),$("#"+n).addClass("block"),$("#"+n).removeClass("hidden")});for(let a=0;a<e.length;a++)$(e[a]).click(function(t){t.preventDefault(),$(e[a]).hasClass("active")?$(e[a]).removeClass("active"):$(e[a]).addClass("active");let n=$(this).parent().next();$(n).hasClass("flex")?$(n).removeClass("flex").addClass("hidden"):$(n).removeClass("hidden").addClass("flex")})},1e3)};function nextLesson(e){parseInt(l.val())+1<=b.val()&&(l.val(parseInt(l.val())+1),w(),x())}function toPage(e){l.val(e),w(),x()}function previousLesson(e){parseInt(l.val())>1&&(l.val(parseInt(l.val())-1),w(),x())}function addProgress(e){mainFunc.getDataParam("api/add-progress",{lessonId:e,memberId:memberId},function(e){})}w(),x(),u.submit(function(e){if(e.preventDefault(),parseInt(h.val().length)>255)return Swal.fire({icon:"error",title:"Failed!",text:"Jumlah karakter > 255"}),!1;mainFunc.getDataParam("api/reviews-rating",{rating:P.val(),review:h.val(),idTransactionDetail:f.val()},function(e){200==e.status?(Swal.fire("Succesfuly!",e.message,"success"),setTimeout(()=>{window.location.href=BASE_URL+"/member/reviews"},2e3)):500==e.status?Swal.fire({icon:"error",title:"Failed!",text:e.message}):Swal.fire({icon:"error",title:"Error!",text:e.message})})}),k.click(function(e){localStorage.setItem("alert-update",1),C.style.display="none"}),h.keyup(()=>{console.log(h.val().length),y.text(`Tersisa : ${255-parseInt(h.val().length)}`),255-parseInt(h.val().length)<10?y.css("color","red"):y.css("color","#000000")})}const alertPayment=e=>{switch(e){case"pending":Swal.fire("Transaksi pending","Segera lakukan proses pembayaran","success");break;case"settlement":Swal.fire({title:"Transaksi telah dibayar",text:"Login ke member area?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Login"}).then(e=>{e.isConfirmed&&(window.location.href=BASE_URL+"/login")});break;case"expire":Swal.fire({title:"Trasaction Expired",text:"Lakukan transaksi ulang?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"transaksi ulang"}).then(e=>{e.isConfirmed&&(window.location.href=BASE_URL+"/repayment")})}},checkoutPage=$("#checkoutPage");if(checkoutPage.length){const e=checkoutPage.find("#formCheckout"),a=checkoutPage.find("#formCheckStatus"),t=checkoutPage.find("#email"),n=checkoutPage.find("#picture"),i=checkoutPage.find("#username"),s=checkoutPage.find("#firstName"),r=checkoutPage.find("#lastName"),o=checkoutPage.find("#password"),l=checkoutPage.find("#whatsapp"),d=checkoutPage.find("#transactionCode"),c=checkoutPage.find("#alertUsername"),m=checkoutPage.find("#kupon"),u=(checkoutPage.find("#firstPrice"),checkoutPage.find("#totalPrice")),f=checkoutPage.find("#totalPriceText"),g=checkoutPage.find("#totalPriceDesc"),p=checkoutPage.find("#validUsername"),b=checkoutPage.find("#btnPayment"),v=checkoutPage.find("#courseId");function hasWhiteSpace(e){return e.indexOf(" ")>=0}function checkData(){mainFunc.getDataParam("api/check-members",{username:i.val()},function(e){let a=hasWhiteSpace(i.val());0==a?400==e.status?(c.html('\n            <small class="text-success">Note: username bisa digunakan.</small>\n          '),p.val("1")):(c.html('\n            <small class="text-danger">Note: username tidak bisa digunakan</small>\n          '),p.val("0")):(c.html('\n          <small class="text-success">Note: username tidak boleh spasi</small>\n        '),p.val("0"))})}function checkKupon(){"JWDCODINGASIK"==m.val()?(u.val("199000"),f.text("Rp 199.000"),g.text("(Discount Kupon Kode)")):"JWDSPESIAL"==m.val()?(u.val("179000"),f.text("Rp 179.000"),g.text("(Discount Kupon Kode + Pre Launch : akan naik sewaktu-waktu)")):(u.val("1996000"),f.text("Rp 1.996.000"),g.text(""))}checkKupon(),i.length&&checkData(),a.submit(function(e){e.preventDefault();let a={transactionCode:d.val()};mainFunc.getDataParam("api/payment-check",a,function(e){if(200==e.status)switch(e.data.transaction_status){case"pending":alertPayment("pending");break;case"settlement":alertPayment("settlement");const a={order_id:e.data.order_id,status_code:e.data.status_code,status_message:e.data.status_message,fraud_status:e.data.fraud_status,transaction_status:e.data.transaction_status,settlement_time:e.data.settlement_time};mainFunc.getDataParam("api/payment-update",a,function(e){});break;case"expire":alertPayment("expire")}else 404==e.status&&Swal.fire({icon:"error",title:"Tidak ditemukan",text:"Periksa kembali kode transaksi kamu"})})}),e.submit(function(e){if(e.preventDefault(),0==p.val())return Swal.fire({icon:"error",title:"Peringatan",text:"Username telah digunakan"}),!1;let a={email:t.val(),picture:n.val(),username:i.val(),firstName:s.val(),lastName:r.val(),password:o.val(),whatsapp:l.val(),totalPrice:u.val(),courseId:v.val()};b.text("Pembayaran diproses ..."),mainFunc.getDataParam("api/payment",a,function(e){if(200==e.status)alertPayment("settlement"),b.text("Proses Pembayaran");else if(201==e.status){if("pending"==e.data.transaction_status)alertPayment("pending");else if("expire"==e.data.transaction_status)b.text("Proses Pembayaran"),alertPayment("expire");else if("settlement"==e.data.transaction_status){alertPayment("settlement");const a={order_id:e.data.order_id,status_code:e.data.status_code,status_message:e.data.status_message,fraud_status:e.data.fraud_status,transaction_status:e.data.transaction_status,settlement_time:e.data.settlement_time};mainFunc.getDataParam("api/payment-update",a,function(e){})}}else 100==e.status&&snap.pay(e.data,{onPending:function(e){let a="",d="";if(e.va_numbers)for(let t=0;t<e.va_numbers.length;t++)a=e.va_numbers[t].bank,d=e.va_numbers[t].va_number;const c={email:t.val(),picture:n.val(),username:i.val(),firstName:s.val(),lastName:r.val(),password:o.val(),whatsapp:l.val(),courseId:v.val(),status_code:e.status_code,status_message:e.status_message,transaction_id:e.transaction_id,transaction_time:e.transaction_time,gross_amount:e.gross_amount,payment_type:e.payment_type,transaction_status:e.transaction_status,fraud_status:e.fraud_status,pdf_url:e.pdf_url,finish_redirect_url:e.finish_redirect_url,order_id:e.order_id,merchant_id:e.merchant_id,signature_key:e.signature_key,qrcode_url:`https://api.sandbox.midtrans.com/v2/gopay/${e.transaction_id}/qr-code`};mainFunc.setCookie("transactionId",e.order_id,15,"m"),mainFunc.setCookie("pdfUrl",e.pdf_url,15,"m"),mainFunc.setCookie("paymentType",e.payment_type,15,"m"),mainFunc.setCookie("qrcodeUrl",`https://api.sandbox.midtrans.com/v2/gopay/${e.transaction_id}/qr-code`,15,"m"),""!=a&&(c.bank=a,c.va_number=d,c.bill_key="",c.biller_code=""),e.bill_key&&(c.bank="mandiri",c.va_number="",c.bill_key=e.bill_key,c.biller_code=e.biller_code),mainFunc.getDataParam("api/payment-save",c,function(e){200==e.status?(Swal.fire("Succesfuly!",c.message,"success"),mainFunc.getData("change-email",function(){}),setTimeout(()=>{window.location.href=BASE_URL+"/thankyou"},2e3)):Swal.fire({icon:"error",title:"Error!",text:c.message}),b.text("Proses Pembayaran")})},onError:function(e){b.text("Proses Pembayaran")}})}),b.text("Proses Pembayaran")})}const repaymentPage=$("#repaymentPage");if(repaymentPage.length){const e=repaymentPage.find("#formRepayment"),a=repaymentPage.find("#formCheckMember"),t=repaymentPage.find("#email"),n=repaymentPage.find("#kuponCode"),i=repaymentPage.find("#boxPayment"),s=repaymentPage.find("#statusMember"),r=repaymentPage.find("#kupon"),o=repaymentPage.find("#totalPrice"),l=repaymentPage.find("#totalPriceText"),d=repaymentPage.find("#totalPriceDesc"),c=repaymentPage.find("#btnPayment"),m=repaymentPage.find("#courseId");function checkKupon(){"JWDCODINGASIK"==r.val()?(o.val("199000"),l.text("Rp 199.000"),d.text("(Discount Kupon Kode)")):"JWDSPESIAL"==r.val()?(o.val("179000"),l.text("Rp 179.000"),d.text("(Discount Kupon Kode + Pre Launch : akan naik sewaktu-waktu)")):(o.val("1996000"),l.text("Rp 1.996.000"),d.text(""))}checkKupon(),a.submit(function(e){e.preventDefault(),mainFunc.getDataParam("api/check-members",{email:t.val()},function(e){200==e.status?(n.removeClass("hidden"),i.removeClass("hidden"),s.html('<span class="text-success">Data ditemukan</span>')):s.html('<span class="text-danger">Data tidak ditemukan</span>')})}),e.submit(function(e){e.preventDefault();let a={email:t.val(),totalPrice:o.val(),courseId:m.val()};c.text("Pembayaran diproses ..."),mainFunc.getDataParam("api/payment",a,function(e){if(200==e.status)alertPayment("settlement"),n.addClass("hidden"),i.addClass("hidden"),c.text("Proses Pembayaran");else if(201==e.status){if("pending"==e.data.transaction_status)alertPayment("pending"),n.addClass("hidden"),i.addClass("hidden"),
c.text("Proses Pembayaran");else if("expire"==e.data.transaction_status){let a={email:t.val(),totalPrice:o.val(),courseId:m.val(),order_id:e.data.order_id};mainFunc.getDataParam("api/payment",a,function(e){snap.pay(e.data,{onPending:function(e){let a="",s="";if(e.va_numbers)for(let t=0;t<e.va_numbers.length;t++)a=e.va_numbers[t].bank,s=e.va_numbers[t].va_number;const r={email:t.val(),courseId:m.val(),status_code:e.status_code,status_message:e.status_message,transaction_id:e.transaction_id,transaction_time:e.transaction_time,gross_amount:e.gross_amount,payment_type:e.payment_type,transaction_status:e.transaction_status,fraud_status:e.fraud_status,pdf_url:e.pdf_url,finish_redirect_url:e.finish_redirect_url,order_id:e.order_id,merchant_id:e.merchant_id,signature_key:e.signature_key,qrcode_url:`https://api.sandbox.midtrans.com/v2/gopay/${e.transaction_id}/qr-code`};mainFunc.setCookie("transactionId",e.order_id,15,"m"),mainFunc.setCookie("pdfUrl",e.pdf_url,15,"m"),mainFunc.setCookie("paymentType",e.payment_type,15,"m"),mainFunc.setCookie("qrcodeUrl",`https://api.sandbox.midtrans.com/v2/gopay/${e.transaction_id}/qr-code`,15,"m"),""!=a&&(r.bank=a,r.va_number=s,r.bill_key="",r.biller_code=""),e.bill_key&&(r.bank="mandiri",r.va_number="",r.bill_key=e.bill_key,r.biller_code=e.biller_code),mainFunc.getDataParam("api/payment-save",r,function(e){200==e.status?(Swal.fire("Succesfuly!",r.message,"success"),n.addClass("hidden"),i.addClass("hidden"),c.text("Proses Pembayaran"),setTimeout(()=>{window.location.href=BASE_URL+"/thankyou"},2e3)):Swal.fire({icon:"error",title:"Error!",text:r.message}),n.addClass("hidden"),i.addClass("hidden"),c.text("Proses Pembayaran")})},onError:function(e){}})})}else if("settlement"==e.data.transaction_status){alertPayment("settlement");const a={order_id:e.data.order_id,status_code:e.data.status_code,status_message:e.data.status_message,fraud_status:e.data.fraud_status,transaction_status:e.data.transaction_status,settlement_time:e.data.settlement_time};mainFunc.getDataParam("api/payment-update",a,function(e){})}}else 100==e.status&&snap.pay(e.data,{onPending:function(e){let a="",s="";if(e.va_numbers)for(let t=0;t<e.va_numbers.length;t++)a=e.va_numbers[t].bank,s=e.va_numbers[t].va_number;const r={email:t.val(),courseId:m.val(),status_code:e.status_code,status_message:e.status_message,transaction_id:e.transaction_id,transaction_time:e.transaction_time,gross_amount:e.gross_amount,payment_type:e.payment_type,transaction_status:e.transaction_status,fraud_status:e.fraud_status,pdf_url:e.pdf_url,finish_redirect_url:e.finish_redirect_url,order_id:e.order_id,merchant_id:e.merchant_id,signature_key:e.signature_key,qrcode_url:`https://api.sandbox.midtrans.com/v2/gopay/${e.transaction_id}/qr-code`};mainFunc.setCookie("transactionId",e.order_id,15,"m"),mainFunc.setCookie("pdfUrl",e.pdf_url,15,"m"),mainFunc.setCookie("paymentType",e.payment_type,15,"m"),mainFunc.setCookie("qrcodeUrl",`https://api.sandbox.midtrans.com/v2/gopay/${e.transaction_id}/qr-code`,15,"m"),""!=a&&(r.bank=a,r.va_number=s,r.bill_key="",r.biller_code=""),e.bill_key&&(r.bank="mandiri",r.va_number="",r.bill_key=e.bill_key,r.biller_code=e.biller_code),mainFunc.getDataParam("api/payment-save",r,function(e){200==e.status?(Swal.fire("Succesfuly!",r.message,"success"),setTimeout(()=>{window.location.href=BASE_URL+"/thankyou"},2e3)):Swal.fire({icon:"error",title:"Error!",text:r.message}),n.addClass("hidden"),i.addClass("hidden"),c.text("Proses Pembayaran")})},onError:function(e){}})})})}const contactPage=$("#contactPage");if(contactPage.length){menuLi.removeClass("active"),desktopMenuContact.addClass("active"),mobileMenuContact.addClass("active");const e=contactPage.find("#formContact"),a=contactPage.find("#inboxSubject"),t=contactPage.find("#inboxMessage"),n=contactPage.find("#btnContact");e.submit(function(e){e.preventDefault(),n.text("Proses Kirim..."),mainFunc.getDataParam("api/message",{inboxSubject:a.val(),inboxMessage:t.val(),memberId:memberId},function(e){200==e.status?Swal.fire("Terimakasih",e.message,"success"):Swal.fire({icon:"error",title:"Error!",text:e.message}),a.val(""),t.val(""),n.text("Kirim")})})}const forgotPasswordPage=$("#forgotPasswordPage");if(forgotPasswordPage.length){const e=forgotPasswordPage.find("#formLupa"),a=forgotPasswordPage.find("#email"),t=forgotPasswordPage.find("#btnLupa");e.submit(function(e){e.preventDefault(),t.text("Proses Kirim..."),mainFunc.getDataParam("api/send-email",{email:a.val()},function(e){200==e.status?(Swal.fire("Email dikirim",e.message,"success"),setTimeout(()=>{window.location.href=BASE_URL+"/reset-password"},2e3)):400==e.status?Swal.fire("Email gagal dikirim",e.message,"success"):Swal.fire({icon:"error",title:"Gagal",text:e.message}),a.val(""),t.text("Kirim")})})}const resetPasswordPage=$("#resetPasswordPage");if(resetPasswordPage.length){const e=resetPasswordPage.find("#formReset"),a=resetPasswordPage.find("#email"),t=resetPasswordPage.find("#kodeVer"),n=resetPasswordPage.find("#passNew"),i=resetPasswordPage.find("#verPass"),s=resetPasswordPage.find("#btnReset");e.submit(function(e){if(e.preventDefault(),n.val()!=i.val())return Swal.fire({icon:"error",title:"Gagal",text:"Pastikan Konfirmasi Password benar"}),!1;s.text("Proses reset..."),mainFunc.getDataParam("api/reset-password",{email:a.val(),kodeVer:t.val(),passNew:n.val()},function(e){200==e.status?(Swal.fire("Succesfuly!",e.message,"success"),a.val(""),t.val(""),n.val(""),i.val(""),setTimeout(()=>{window.location.href=BASE_URL+"/login"},2e3)):500==e.status?Swal.fire({icon:"error",title:"Failed!",text:e.message}):Swal.fire({icon:"error",title:"Gagal",text:e.message}),s.text("Reset Password")})})}const invoicePage=$("#invoicePage");if(invoicePage.length){const e=invoicePage.find("#transactionCode"),a=invoicePage.find("#fullName"),t=invoicePage.find("#email"),n=invoicePage.find("#dateBuy"),i=invoicePage.find("#datePaid"),s=invoicePage.find("#bodyInvoice"),r=invoicePage.find("#code");mainFunc.getDataParam("api/invoice",{transactionCode:e.val()},function(e){a.text(`${e.data.first_name} ${e.data.last_name}`),t.text(e.data.email),n.text(e.data.transaction_time),i.text(e.data.paid_at),r.text(e.data.transaction_code),s.html(`\n      <tr class="my-4">\n        <td class="p-2">1</td>\n        <td class="text-primary font-semibold">${e.data.course_name}</td>\n        <td>Rp ${mainFunc.formatIdr(e.data.gross_amount)}</td>\n      </tr>\n    `)})}